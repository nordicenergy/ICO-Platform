function Model(){function t(t,i,r){var u=this;console.log("bonus period, endDAte "+t);u.beginDate=ko.computed(function(){for(var i=n.periods(),r=i.indexOf(u),t;;){if(t=i[--r],t==null)return n.startDate();if(t.endDate())return t.endDate()}});u.endDate=ko.observable(t);u.stratAmount=i;u.btcAmount=r;u.valid=ko.computed(function(){return u.beginDate()<=u.endDate()});console.log("is period valid "+u.valid());u.setMinDate=function(t,i){n.setMinDate(i.currentTarget,t.beginDate())}}var n=this;console.log("Model()");n.periods=ko.observableArray();n.stratisExtPubKeyEnabled=data.stratisExtPubKeyEnabled;n.bitcoinExtPubKeyEnabled=data.bitcoinExtPubKeyEnabled;n.kycSelectedId=ko.observable(data.kycSelectedId);n.startDate=ko.observable(new Date(data.startDate));n.offset=function(){return moment().utcOffset()};n.setMinStartDate=function(t,i){var r=n.startDate()<new Date?n.startDate():new Date;n.setMinDate(i.currentTarget,r)};n.setMinDate=function(n,t){console.log("set min date");$(n).bootstrapMaterialDatePicker("setMinDate",moment(t))};n.init=function(){if(console.log("Model init with existing periods"),_.each(data.periods,function(i){n.addPeriod(new t(new Date(i.endDate),i.stratAmount,i.btcAmount))}),data.periods.length==0){var i=moment().add(1,"days").toDate();n.addPeriod(new t(i,0,0))}};n.format=function(n){return n=ko.unwrap(n),moment(n).format(dateFormat)};n.hasInvalidPeriod=ko.computed(function(){return n.periods().some(function(n){return console.log("begin date "+n.beginDate()),console.log("end date "+n.endDate()),!n.valid()})});n.submitAttempted=ko.observable(!1);n.save=function(){return n.submitAttempted(!0),!n.hasInvalidPeriod()&&n.disclaimerValid()?!0:void 0};n.disclaimerRead=ko.observable(data.disclaimerAgreement);n.disclaimerAgreement=ko.observable(data.disclaimerAgreement);n.disclaimerValid=ko.computed(function(){return n.disclaimerAgreement()||n.disclaimerRead()});n.scrollDisclaimer=function(t,i){var r=$(i.currentTarget);r.scrollTop()+r.innerHeight()+1>=i.currentTarget.scrollHeight&&n.disclaimerRead(!0)};n.add=function(){console.log("Add NULL Period");var i=_.last(n.periods()),r=i==null?new Date:moment(i.endDate()).add(1,"days").toDate();n.addPeriod(new t(r,0,0))};n.addPeriod=function(t){console.log("Add Period to Periods");n.periods.push(t);var i=t.beginDate();i<new Date&&(i=new Date);$("#sales-table tr:last .date").bootstrapMaterialDatePicker("setMinDate",moment(i))};n.remove=function(t){n.periods.remove(t)}}var dateFormat="YYYY/MM/DD HH:mm",model;ko.bindingHandlers.dateTimePicker={init:function(n,t,i){console.log("datetimepicker init");var r=$.extend({showTodayButton:!0,showClose:!0,format:dateFormat,useCurrent:!1},i().dateTimePickerOptions||{});$(n).bootstrapMaterialDatePicker(r);ko.utils.registerEventHandler(n,"change",function(){var i,r;console.log("datetimepicker register");i=t();ko.isObservable(i)&&(r=$(n).val(),i(new Date(r)))});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){console.log("datetimepicker addDisposeCallback");$(n).bootstrapMaterialDatePicker("destroy")})},update:function(n,t){console.log("datetimepicker update");var i=ko.unwrap(t());$(n).bootstrapMaterialDatePicker("setDate",moment(i))}};model=new Model;ko.applyBindings(model);model.init();